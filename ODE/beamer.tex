\documentclass{myBeamer}

%% Title page
\title{Ordinary Differential Equations}
\subtitle{as an alternative to agent-based modelling}
\author{Module}
\date{\today}
%\institute{Institut\\
%\bigskip
%\includegraphics[scale=2]{figures/logos/openmole.png}}



\begin{document}

\begin{frame}[plain]
	\titlepage
\end{frame}
\addtocounter{framenumber}{-1}

\AtBeginSection[]
{
	\frame{
		\sectionpage
	}
	\addtocounter{framenumber}{-1}
}


\section{ODE systems}

\sframe{The ODE framework}{
	$\rightarrow$ widely used to model transmission phenomena\\
	
	\bigskip
	
	\begin{columns}
	\begin{column}{.5\textwidth}
		\begin{itemize}
			\item population split into compartments
			\item system of ordinary differential equations
		\end{itemize}
	\end{column}
	
	\begin{column}{.5\textwidth}
		\includegraphics[width=\textwidth]{figures/SIR.jpg}\\
		
		\begin{eqnarray*}
		\left\{
		\begin{array}{lcl}
			\dv{S}{t}  & = &  -\beta S + \lambda I \\
			\tmspace{1mu}&& \\
			\dv{I}{t} & = & \beta S - (\lambda + \gamma)I \\
			\tmspace{1mu}&& \\
			\dv{R}{t} & = & \gamma I
		\end{array}
		\right.
		\end{eqnarray*}
	\end{column}
	\end{columns}
}


\sframe{SIR model dynamics}{
	\includegraphics[width=\textwidth]{figures/SIR_dynamics.png}
}


\sframe{ODE vs ABM}{
	\begin{table}
 	\begin{tabular}{ll}
 		\thead{\head{ODE}} & \thead{\head{ABM}} \\
		Equation-based & Individual-based \\
		Generic mechanisms & Precise mechanisms \\
		Population scale & Individual scale \\
		Needs less resources & Computationally  expensive
  	\end{tabular}
  	\end{table}
}


\section{A Zombie situation}

\sframe{An ODE model for our Zombie problem}{
	\head{How could we model the Zombie invasion?}
	
	\begin{itemize}
		\item Which mechanisms?
		\item Which parameters?
	\end{itemize}
	
	\bigskip
	
	\visible<2>{
	\head{How can we assess our model's ability to reproduce the real data?}
	
	\begin{itemize}
		\item Which metrics?
		\item Which fitness function?
	\end{itemize}
	}
}


\sframe{A very simple ODE model}{
	\begin{center}
	\includegraphics[width=.7\textwidth]{figures/simpleODE.png}
	\end{center}
}


\sframe{A very simple ODE model}{
	\begin{center}
	\includegraphics[width=.35\textwidth]{figures/simpleODE.png}
	\end{center}
	
	\begin{eqnarray*}
		\left\{
		\begin{array}{lcl}
			\dv{H_{walk}}{t}  & = &  -(panic + inf) * H_{walk} + exhaustH * H_{run} \\
			\tmspace{1mu}&& \\
			\dv{H_{run}}{t} & = & panic * H_{walk} - (exhaustH + inf) * H_{run} \\
			\tmspace{1mu}&& \\
			\dv{Z_{walk}}{t} & = & inf * (H_{walk} + H_{run}) - hunt * Z_{walk} + exhaustZ * Z_{run} \\
			\tmspace{1mu}&& \\
			\dv{Z_{run}}{t} & = & hunt * Z_{walk} - exhaustZ * Z_{run}
		\end{array}
		\right.
	\end{eqnarray*}
}


\section{Exploration}

\sframe{First step: Calibrate}{
	\begin{center}
	We have some real time series of zombie invasion \\
	$\rightarrow$ find the parameter values to best fit them
	\end{center}
	
	\bigskip
	
	\visible<2->{
	\head{Process}
	
	\begin{itemize}
		\visible<3->{\item Embed the model in OpenMOLE}
		\visible<4->{\item Define a fitness function}
		\visible<5->{\item Write a calibration task}
	\end{itemize}
	}
}


\sframe{Calibration results}{
	\head{Parameter set} \\
	
	\bigskip
	
%	\includegraphics[width=\textwidth]{figures/calib.png}
}


\sframe{Second step: Profiles}{

}


\section{Adding complexity}

\sframe{New mechanisms}{
	\begin{center}
	\head{What mechanisms could we add to better represent the complexity of our Zombie situation?}
	\end{center}
	
	\bigskip
	
	
}


\sframe{Study our model's parcimony}{

}




 

\sframe{Few maths remarks}{
	Recall the ODE system:	
	
	\bigskip
			
\fontsize{8pt}{9pt}\selectfont
		$\left\{
		\begin{array}{lcl}
			\dv{H_{walk}}{t}  & = &  -(panic0 * \frac{Z_{walk}+Z_{run}}{N} + inf) * H_{walk} + exhaustH * H_{run}  \\
			\tmspace{1mu}&& \\
			\dv{H_{run}}{t} & = & panic0 * \frac{Z_{walk}+Z_{run}}{N} * H_{walk} - (exhaustH + inf) * H_{run} \\
			\tmspace{1mu}&& \\
			\dv{Z_{walk}}{t} & = & inf * (H_{walk} + H_{run}) - hunt0 * \frac{H_{walk}+H_{run}}{N} * Z_{walk} + exhaustZ * Z_{run} \\
			\tmspace{1mu}&& \\
			\dv{Z_{run}}{t} & = & hunt0 * \frac{H_{walk}+H_{run}}{N}* Z_{walk} - exhaustZ * Z_{run}
		\end{array}
		\right.
		$
%\normalsize
\bigskip
\bigskip

Where $N := H_{walk}+H_{run}+Z_{walk}+Z_{run}$

\bigskip
\normalsize
%
First-order \textbf{nonlinear} (autonomous) ordinary differential equation... a priori no explicit solution, hence numerical solutions.
%Equation différentielle \textbf{non linéaire} d'ordre 1... a priori on ne sait pas trouver de solutions explicites, d'où la résolution numérique

}




\sframe{Cauchy Problem}{

Let's note $X(t) :=  (H_{walk}(t),H_{run}(t),Z_{walk}(t),Z_{run}(t)) $

We have the following Cauchy problem:

$$ 
\left\{
\begin{array}{llll}
X'(t) & = &  F(X(t)) & \\ 
X(0) & = & (x_0,y_0,z_0,w_0) & \text{ initial condition}
\end{array}
\right.
$$

where  

$$ (x_0,y_0,z_0,w_0)  \in \mathbb{R}_+^* $$

and

\fontsize{7pt}{8pt}\selectfont
$$\begin{array}{lllll}
F & : & \mathbb{R}^4 & \to     & \mathbb{R}^4 \\
  &   &   (x,y,z,w)       &  \mapsto &  F(x,y,z,w) := ((panic0 * \frac{z+w}{x+y+z+w} + inf) * x + exhaustH * y,  \\
  & & & &  \hspace{2cm} \ldots,\ldots,\ldots)
\end{array}$$

\normalsize
Cauchy-Lipschitz theorem : Existence and uniqueness to a solution of the Cauchy problem.

}




\sframe{Total population size}{

Summing the 4 equations, we have:

$$ \dv{N}{t} = \dv{H_{walk}}{t} + \dv{H_{run}}{t} + \dv{Z_{walk}}{t} + \dv{Z_{run}}{t} =0 $$

So $N(t)$ is constant:
$$ N(t) = N(0), \text{ for all } t.$$

We find back that the population size (human + zombies) is constant : natural !

}



\sframe{Human / zombies population size}{

Let's note $ H := H_{walk} + H_{run}$

Summing the first equations, we have:

$$ \dv{H}{t} = \dv{H_{walk}}{t} + \dv{H_{run}}{t}  = - inf (H_{walk}(t) +H_{run}(t)) = - inf  H(t)$$

First-order linear ordinary differential equation with constant coefficient: explicit solution !
%Equation différentielle linéaire d'ordre 1 à coefficient constant pour $H$: on sait résoudre !

$$ H(t) = H(0) * e^{-inf *t} $$

Likewise, $$ Z(t) := Z_{walk} + Z_{run} = N - H(t) $$

}


\sframe{Equilibrium points}{


Definition: The point $x \in \mathbb{R}^4$ is an equilibrium point for the differential equation $X' = F(X)$ if $F(X) = 0$.

\bigskip
\bigskip

Here, there is a unique equilibrium point: $(0,0,0,N(0))$: all the population is composed of walking zombies.

}


\sframe{Link with Parcimony}{

Theses 2 facts : $N(t)$ constant and solutions for $H$ and $Z$ are still valid for the system with additional mechanism.

Not able to change the shape of the solutions of the equation of $H$ and $Z$ with such system modifications.

}





%% Stop numbering
\backupbegin

\appendix
%\begin{frame}[plain]{Acknowledgements}
%	\begin{center}
%	\head{Lab:}\\
%	
%	\medskip
%	XXX\\
%	\medskip
%	YYY\\
%	\medskip
%	ZZZ\\
%	
%	\bigskip
%	Logos
%	\end{center}
%	
%	\visible<2>{
%	\bigskip
%	\begin{LARGE}
%		\begin{center}
%		\head{Thank you for your attention!}
%		\end{center}
%	\end{LARGE}
%	}
%\end{frame}

%\input{parts/backup}

\backupend

\end{document}